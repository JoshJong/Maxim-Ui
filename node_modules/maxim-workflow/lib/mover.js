
var fse = require('fs-extra');
var path = require('path');

function Copyfile(){}
Copyfile.prototype = {
    copyFile : function(files,Config,callback){
        var results = [];
        var index = files.length;

        files.forEach(function(file){
            var relativeFile = file.replace(Config.destPath, '').replace(Config.localPath, '');
            var destPath = path.join(Config.destPath,relativeFile);

            fse.copy(file, destPath, function (err) {
                if (err) {
                    results.push({
                        status:false,
                        fName:destPath.replace(config.destPath, '').replace(config.localPath, '').replace(/\\/g, '\/'),
                        message: err.message
                    });

                    index--;
                    if(index <= 0){
                        callback(results);
                    }
                    return;
                }

                results.push({
                    status:true,
                    fName:destPath.replace(Config.destPath, '').replace(Config.localPath, '').replace(/\\/g, '\/')
                });
                index--;
                if(index <= 0){
                    callback(results);
                }
            });
        });
    }
};
module.exports = Copyfile;